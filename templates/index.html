<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/styles.css">
    <title>CV Text Improver</title>
</head>
<body>
  <header>
    <h1>Welcome to CV Text Improver</h1>
      <p>Enhance your CV effortlessly with our powerful tools</p>
    </header>

    <div class="container">
        <h1>Input Text</h1>
        <textarea id="input-text" placeholder="Paste your CV text here..."></textarea>
        <button id="improve-btn">Improve Text</button>

        <!-- hidden part -->
        <div id="output-container">
            <div id="score">

                <div id="circular-progress-container">
                    <svg viewBox="0 0 100 100" class="progress-bar">
                      <circle cx="50" cy="50" r="45" class="background-circle"></circle>
                      <circle cx="50" cy="50" r="45" class="progress-circle"></circle>
                    </svg>
                    <span id="progress-value" class="progress-value">0%</span>
                </div>

                <div id="circular-progress-container">
                    <svg viewBox="0 0 100 100" class="progress-bar">
                      <circle cx="50" cy="50" r="45" class="background-circle"></circle>
                      <circle cx="50" cy="50" r="45" class="progress-circle"></circle>
                    </svg>
                    <span id="progress-value" class="progress-value">0%</span>
                </div>

                
            </div>
            
            <div>
                <h2>Improved Text</h2>
                <p id="output-text"></p>
            </div>
            
        </div>
    </div>

    
    <script>
        document.getElementById('improve-btn').addEventListener('click', async () => {
            const inputText = document.getElementById('input-text').value;
    
            // Fetch the improved text from the server
            const response = await fetch('/improve', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: inputText })
            });
    
            const data = await response.json();
    
            // Display the improved text
            const improvedText = data.improved_text || data.error;
            const outputContainer = document.getElementById('output-container');
            const outputText = document.getElementById('output-text');
    
            if (improvedText.trim()) {
                outputText.textContent = improvedText;
                outputContainer.style.maxHeight = '500px'; // Set a height sufficient to fit content
                outputContainer.style.opacity = '1'; // Fade in
    
                // Wait for the text to be displayed, then update progress
                const score = Math.floor(Math.random() * 101); // Example: Generate a random score (replace with actual logic)
                updateProgress(score); // Pass the calculated score
            } else {
                outputContainer.style.maxHeight = '0'; // Hide the container
                outputContainer.style.opacity = '0'; // Fade out
            }
        });
    
        // Circular progress bar logic
        const progressCircle = document.querySelector(".progress-circle");
        const progressValue = document.getElementById("progress-value");
    
        function updateProgress(value) {
            const max = 100;
            const percent = (value / max) * 100;
            const offset = 283 - (283 * percent) / 100; // Calculate stroke offset
    
            // Update the progress circle and value with smooth animation
            progressCircle.style.strokeDashoffset = offset;
            progressValue.textContent = `${percent.toFixed(0)}%`;
        }
    
        // Ensure the circle animation is smooth
        progressCircle.style.transition = "stroke-dashoffset 1s ease-in-out";
    </script>
    
               

</body>
</html>
